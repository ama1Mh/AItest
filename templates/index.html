<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Image Workflow</title>

  <!-- AdminLTE & dependencies -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>

  <style>
    .drop-zone {
      border: 2px dashed #6c757d;
      border-radius: 10px;
      padding: 2rem;
      text-align: center;
      color: #6c757d;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    .drop-zone.dragover {
      background-color: #f8f9fa;
      border-color: #007bff;
      color: #007bff;
    }

    #output {
      white-space: pre-wrap;
      background: #f4f6f9;
      padding: 1rem;
      border-radius: 0.5rem;
      border: 1px solid #dee2e6;
    }
  </style>
</head>
<body class="hold-transition sidebar-mini layout-fixed">

<div class="wrapper">
  <!-- Main Sidebar -->
  <aside class="main-sidebar sidebar-dark-primary elevation-4">
    <!-- Brand Logo -->
    <a href="#" class="brand-link">
      <i class="fas fa-robot ml-3 mr-2"></i>
      <span class="brand-text font-weight-light">AI Workflow</span>
    </a>

    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Sidebar Menu -->
      <nav class="mt-2">
        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu">
          <li class="nav-item">
            <a href="/adminlte" class="nav-link">
              <i class="nav-icon fas fa-tachometer-alt"></i>
              <p>Go to Dashboard</p>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </aside>

  <!-- Content Wrapper -->
  <div class="content-wrapper p-4">
    <section class="content">
      <div class="container-fluid">
        <div class="card card-primary">
          <div class="card-header">
            <h3 class="card-title">AI Image Detection</h3>
          </div>
          <div class="card-body">
            <div class="drop-zone mb-3" id="drop-zone">
              <i class="fas fa-upload fa-2x mb-2"></i><br>
              Drag & drop your image here or click to browse
              <input type="file" name="image" id="file-input" accept="image/*" hidden required />
            </div>

            <button class="btn btn-primary" id="submit-btn">
              <i class="fas fa-magic"></i> Analyze Image
            </button>

            <div class="mt-4" id="output"></div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<script>
  const dropZone = document.getElementById("drop-zone");
  const fileInput = document.getElementById("file-input");
  const submitBtn = document.getElementById("submit-btn");
  const output = document.getElementById("output");

  dropZone.addEventListener("click", () => fileInput.click());

  dropZone.addEventListener("dragover", (e) => {
    e.preventDefault();
    dropZone.classList.add("dragover");
  });

  dropZone.addEventListener("dragleave", () => {
    dropZone.classList.remove("dragover");
  });

  dropZone.addEventListener("drop", (e) => {
    e.preventDefault();
    dropZone.classList.remove("dragover");
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      fileInput.files = files;
    }
  });

  submitBtn.addEventListener("click", async () => {
    if (!fileInput.files.length) {
      alert("Please upload an image first.");
      return;
    }

    const formData = new FormData();
    formData.append("image", fileInput.files[0]);

    const response = await fetch("/upload", {
      method: "POST",
      body: formData
    });

    const result = await response.json();
    output.innerHTML = `<h5>Detection Report</h5><pre>${JSON.stringify(result, null, 2)}</pre>`;
  });
</script>

</body>
</html>
